(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{581:function(t,s,a){t.exports=a.p+"assets/img/programmer-5-years.aecba2c2.png"},582:function(t,s,a){t.exports=a.p+"assets/img/rm-rf2.bce625b1.jpeg"},583:function(t,s,a){t.exports=a.p+"assets/img/change.1f9e3b77.png"},584:function(t,s,a){t.exports=a.p+"assets/img/computer-learn.563f1959.jpeg"},585:function(t,s,a){t.exports=a.p+"assets/img/avoid-rm.147b1c6d.jpeg"},602:function(t,s,a){"use strict";a.r(s);var n=a(12),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"google-zx-中文版"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#google-zx-中文版"}},[t._v("#")]),t._v(" Google zx 中文版")]),t._v(" "),n("img",{staticStyle:{width:"auto",height:"auto"},attrs:{src:a(581)}}),t._v(" "),n("h2",{attrs:{id:"简介"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#简介"}},[t._v("#")]),t._v(" 简介")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://anprettyboy.github.io/handsome-man/",target:"_blank",rel:"noopener noreferrer"}},[t._v("2021年度最流行项目"),n("OutboundLink")],1),t._v("是"),n("a",{attrs:{href:"https://github.com/google/zx",target:"_blank",rel:"noopener noreferrer"}},[t._v("zx"),n("OutboundLink")],1),t._v("，一个由谷歌推出的全新的工具，可用于以 JavaScript 或 TypeScript 编写简单的命令行脚本。")]),t._v(" "),n("p",[t._v("基本上它可以让你在代码中嵌入任何 bash 表达式（ls, cat, git...等任何命令！），并通过"),n("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Operators/await",target:"_blank",rel:"noopener noreferrer"}},[t._v("await操作符"),n("OutboundLink")],1),t._v("使用"),n("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals",target:"_blank",rel:"noopener noreferrer"}},[t._v("JavaScript template literals"),n("OutboundLink")],1),t._v("的结果。")]),t._v(" "),n("p",[t._v("它引入了由几个流行的软件包提供的实用工具：")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://github.com/node-fetch/node-fetch",target:"_blank",rel:"noopener noreferrer"}},[t._v("node-fetch"),n("OutboundLink")],1),t._v(" 与浏览器中"),n("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API",target:"_blank",rel:"noopener noreferrer"}},[t._v("Fetch"),n("OutboundLink")],1),t._v("有着相同的 API， 可创建 HTTP 请求。")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/jprichardson/node-fs-extra",target:"_blank",rel:"noopener noreferrer"}},[t._v("fs-extra"),n("OutboundLink")],1),t._v(" 可处理文件系统操作。")]),t._v(" "),n("li",[n("a",{attrs:{href:"https://github.com/sindresorhus/globby",target:"_blank",rel:"noopener noreferrer"}},[t._v("globby"),n("OutboundLink")],1),t._v(" 以用户友好模式来匹配给定的文件名。")])]),t._v(" "),n("h2",{attrs:{id:"背景"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#背景"}},[t._v("#")]),t._v(" 背景")]),t._v(" "),n("p",[t._v('"Bash 很棒，但是在编写脚本时，人们通常会选择更方便的编程语言。 JavaScript 是一个完美的选择，但标准的 Node.js 库在使用之前需要额外的麻烦。 zx 包提供了围绕 child_process 的有用包装器，转义参数并提供合理的默认值。"')]),t._v(" "),n("h3",{attrs:{id:"扔砖引玉"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#扔砖引玉"}},[t._v("#")]),t._v(" 扔砖引玉")]),t._v(" "),n("img",{staticStyle:{width:"auto",height:"auto"},attrs:{src:a(582)}}),t._v(" "),n("p",[t._v('"想象一下，你本来想删除：rm -rf $dir/'),n("em",[t._v("然后dir是空的时候，变成了什么？rm -rf是删除命令，$dir是空的话，相当于执行 rm -rf /")]),t._v(',这是删除所有文件和文件夹。。。然后，你的系统就没了，这就是传说中的删库跑路吗~~~~"')]),t._v(" "),n("h2",{attrs:{id:"历史"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#历史"}},[t._v("#")]),t._v(" 历史")]),t._v(" "),n("img",{staticStyle:{width:"auto",height:"auto"},attrs:{src:a(583)}}),t._v(" "),n("h3",{attrs:{id:"使用javascript写shell脚本"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用javascript写shell脚本"}},[t._v("#")]),t._v(" 使用javascript写shell脚本")]),t._v(" "),n("p",[t._v("#! 是一个约定的标记，它告诉系统这个脚本需要什么解释器来运行，即：使用哪一种 shell。#!被称为"),n("a",{attrs:{href:"https://zh.wikipedia.org/wiki/Shebang",target:"_blank",rel:"noopener noreferrer"}},[t._v("shebang（也称为 Hashbang）"),n("OutboundLink")],1),t._v(",例如使用 bash：#! /bin/bash")]),t._v(" "),n("p",[t._v("最简单的脚本")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/usr/bin/env node")]),t._v("\nconsole.log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'hello world'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("保存为test，执行该脚本 node test,然后可以在控制台获得输出。")]),t._v(" "),n("p",[t._v("更进一步，我们给该脚本一个执行权限，")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("chmod")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("755")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("\n")])])]),n("h4",{attrs:{id:"例子-读取给定文件夹下所有的文件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#例子-读取给定文件夹下所有的文件"}},[t._v("#")]),t._v(" 例子-读取给定文件夹下所有的文件")]),t._v(" "),n("p",[t._v("读取当前文件夹使用 fs.readdirSync方法，该方法会返回一个数组，包含了给定文件夹下的所有子文件夹或文件,")]),t._v(" "),n("p",[t._v("举个栗子，在当前目录我有个test文件夹")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v("\n├── "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(".html\n├── "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(".txt\n└── files\n")])])]),n("p",[t._v("fs.readdirSync('./test') 的输出为 [ '1.html', '1.txt', 'files' ]")]),t._v(" "),n("p",[t._v("新建个文件，getFile，用来存放脚本代码")]),t._v(" "),n("h4",{attrs:{id:"写死的文件夹"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#写死的文件夹"}},[t._v("#")]),t._v(" 写死的文件夹")]),t._v(" "),n("p",[t._v("读取给定目录下所有文件并输出的代码如下：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/usr/bin/env node")]),t._v("\n\nconst testFolder "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./test/'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconst fs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" require"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nfs.readdirSync"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("testFolder"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".forEach"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console.log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("h4",{attrs:{id:"获取用户输入"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#获取用户输入"}},[t._v("#")]),t._v(" 获取用户输入")]),t._v(" "),n("p",[t._v("以上代码的给定的路径是写死的，我们需要作为参数输入，nodejs读取用户输入的方法:")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("const "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nodeEnv,dir,"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("process.argv //args是用户输入的参数\n")])])]),n("p",[t._v("修改脚本代码：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/usr/bin/env node")]),t._v("\n\nconst fs "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" require"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconst "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("nodeEnv,dir,"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("process.argv\n\n// 获取用户输入的路径\nconst "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("folder")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("args"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\nfs.readdirSync"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("folder"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".forEach"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console.log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("file"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),n("p",[t._v("现在执行脚本时，路径就可以自己输入了")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("node")]),t._v(" getFile 你的路径\n")])])]),n("h3",{attrs:{id:"原生方式child-process"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#原生方式child-process"}},[t._v("#")]),t._v(" 原生方式child_process")]),t._v(" "),n("p",[t._v("nodejs可以使用child_process模块新建子进程，用来执行unit系统命令，写个测试的例子，如下所示：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/usr/bin/env node")]),t._v("\n\n\n//-----同步写法👇\nconst "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("execSync")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("require"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'child_process'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".execSync\n\nconst "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("res")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("execSync"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ls'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconsole.log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"res"')]),t._v(", res.toString"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),t._v("\n\n\n// ----- 异步写法👇\nconst "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("exec")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("require"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'child_process'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".exec\nexec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ls'")]),t._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err,stdout,stderr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n   if"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("err"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("throw err\n   console.log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("stdout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("h3",{attrs:{id:"shelljs执行linux命令行"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#shelljs执行linux命令行"}},[t._v("#")]),t._v(" shelljs执行linux命令行")]),t._v(" "),n("p",[t._v("首先需要安装shelljs")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("npm i shelljs -S\n")])])]),n("p",[t._v("shelljs提供了很多方法，最常用的是exec，举个栗子")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("const "),n("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("shell")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("require"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'shelljs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n/**\n * 函数签名：exec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("command "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(", options"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(", callback"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n * command:要执行的命令\n * callback:回调函数，对command的输出进行处理\n * options:\n *  async: 异步执行.如果callback提供了，会忽略该参数并强制异步执行  "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default: "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n *  fatal: Exit upon error "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default: "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".\n *  silent: 不在console中输出"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default: "),n("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".\n *  encoding: 设置stdout和stderr的编码 "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("default: "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'utf8'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n */\n\n//输出ls的结果\nshell.exec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ls"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n//callback"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code,stdout,stderr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  code为0则成功，否则失败\nshell.exec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dir"')]),t._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("silent:true"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code,stdout,stderr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nshell.exec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'ls'")]),t._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("silent:true"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(","),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code,stdout,stderr"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console.log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("code"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    console.log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("stdout"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("img",{staticStyle:{width:"auto",height:"auto"},attrs:{src:a(584)}}),t._v(" "),n("p",[t._v("在开发过程中，常会遇到如下命令：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("add")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(".")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -m "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'*****'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" push\n")])])]),n("ol",[n("li",[t._v("在根目录下新建文件shell.js，内容如下：")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" shell "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" require"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'shelljs'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" name "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" process.argv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Auto-commit'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exec")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" shell.exec\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'git add .'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".code "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    echo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Error: Git add failed'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    exit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("git")]),t._v(" commit -am "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${name}")]),t._v('"')]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".code "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    echo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Error: Git commit failed'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    exit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("exec"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'git push'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(".code "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    echo"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Error: Git commit failed'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    exit"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("ol",{attrs:{start:"2"}},[n("li",[t._v("只用一条命令执行以上所有任务，在package.json中加入,方法如下:")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"script"')]),t._v(":"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"push"')]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v(":")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"node ./shell.js"')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("ol",{attrs:{start:"3"}},[n("li",[t._v("执行")])]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" run push 测试shelljs提交代码\n")])])]),n("h3",{attrs:{id:"用spawn-来编写跨平台-node-js命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#用spawn-来编写跨平台-node-js命令"}},[t._v("#")]),t._v(" 用spawn 来编写跨平台 Node.js命令")]),t._v(" "),n("p",[t._v("如果想要编写跨平台的 spawn 命令，而又不想增加额外的开销的话，可以这样写")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("const process "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" require"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'process'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nconst "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" spawn "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" require"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'child_process'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\nspawn"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'npm'")]),t._v(", "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n stdio: "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'inherit'")]),t._v(",\n // 仅在当前运行环境为 Windows 时，才使用 shell\n shell: process.platform "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'win32'")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n")])])]),n("h4",{attrs:{id:"cross-spawn第三方模块"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cross-spawn第三方模块"}},[t._v("#")]),t._v(" cross-spawn第三方模块")]),t._v(" "),n("p",[t._v("关于 spawn 函数的跨平台写法，除了自己编写代码的时候做处理，也有第三方模块封装好了相关细节，如 cross-spawn。")]),t._v(" "),n("p",[t._v("使用该模块，可以在调用 spawn 函数时，自动根据当前的运行平台，来决定是否生成一个 shell 来执行所给的命令。对命令和参数中的字符进行转义更为方便。")]),t._v(" "),n("img",{staticStyle:{width:"auto",height:"auto"},attrs:{src:a(585)}}),t._v("\n### Google zx\n"),n("p",[t._v("“Bash很好，所以我选择JavaScript”")]),t._v(" "),n("p",[t._v("前端开发拿手的不就是 Javascript, 嗯 开整")]),t._v(" "),n("h4",{attrs:{id:"安装和使用"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#安装和使用"}},[t._v("#")]),t._v(" 安装和使用")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("npm")]),t._v(" i -g zx\n")])])]),n("p",[t._v("安装好 zx 之后，将编写的脚本放在 .mjs 后缀的文件中，或者使用 .js 后缀，但是需要使用 void async function () {...}() 对脚本进行包装。")]),t._v(" "),n("p",[t._v("使用时需注意以下几点：")]),t._v(" "),n("h4",{attrs:{id:"_1、脚本需要包含以下文件头"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_1、脚本需要包含以下文件头"}},[t._v("#")]),t._v(" 1、脚本需要包含以下文件头：")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("#!/usr/bin/env zx\n")])])]),n("h4",{attrs:{id:"_2-为脚本添加执行权限再运行"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_2-为脚本添加执行权限再运行"}},[t._v("#")]),t._v(" 2. 为脚本添加执行权限再运行")]),t._v(" "),n("div",{staticClass:"language- extra-class"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[t._v("$ chmod +x ./script.mjs\n$ ./script.mjs\n\n# 或者使用这个命令\n$ zx ./script.mjs\n")])])]),n("h4",{attrs:{id:"zx-常用命令"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#zx-常用命令"}},[t._v("#")]),t._v(" zx 常用命令")]),t._v(" "),n("h5",{attrs:{id:"command"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#command"}},[t._v("#")]),t._v(" $"),n("code",[t._v("command")])]),t._v(" "),n("p",[t._v("使用 child_process 包中提供的 exec 函数，可以把字符串当做命令执行，并返回一个 Promise(ProcessOutput) 对象。通过的一切${...}都会被自动转义和引用。")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" count "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" parseInt"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("await $"),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" -1 "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("wc")]),t._v(" -l"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nconsole.log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),t._v("Files count: $"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("count"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[t._v("要并行上传文件，可以使用下面的脚本：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" hosts "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v("."),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nawait Promise.all"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("hosts.map"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("host "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  $"),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("rsync")]),t._v(" -azP ./src $"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("host"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(":/var/www"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),t._v("\n")])])]),n("p",[t._v("要修改工作路径，可以使用 cd() 方法：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("cd"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/tmp'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n// 将输出 /tmp\nawait $"),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n")])])]),n("p",[t._v("fetch() 方法是对 node-fetch 包的包装：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" resp "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" await fetch"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://wttr.in'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("resp.ok"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  console.log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("await resp.text"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),n("p",[t._v("question() 方法是对 readline 包的包装：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("type")]),t._v(" QuestionOptions "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" choices: string"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" question"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("query: string, options?: QuestionOptions"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(": Promise"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("string"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])])]),n("p",[t._v("用法：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" username "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" await question"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'What is your username? '")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" token "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" await question"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Choose env variable: '")]),t._v(", "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  choices: Object.keys"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("process.env"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[t._v("对于 chalk 包，不需要导入就可以直接用：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("console.log"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("chalk.blue"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Hello world!'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("))")]),t._v("\n")])])]),n("p",[t._v("fs 包，导入就可以直接用：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("let")]),t._v(" content "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" await fs.readFile"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./package.json'")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),n("p",[t._v("Promisified 默认被引入了，等同于以下代码：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("promises as fs"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" from "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'fs'")]),t._v("\n")])])]),n("p",[t._v("os 包，导入就可以直接用：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("await $"),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("cd")]),t._v(" $"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("os.homedir"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("&&")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("mkdir")]),t._v(" example"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n")])])]),n("p",[t._v("zx 还可以从其他脚本导入：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[n("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/usr/bin/env node")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("import")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("$"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" from "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zx'")]),t._v("\nawait $"),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("date")]),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n")])])]),n("p",[t._v("传递环境变量：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("process.env.FOO "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'bar'")]),t._v("\nawait $"),n("span",{pre:!0,attrs:{class:"token variable"}},[n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),n("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("echo")]),t._v(" $FOO"),n("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("\n")])])]),n("p",[t._v("执行远程脚本：")]),t._v(" "),n("div",{staticClass:"language-shell extra-class"},[n("pre",{pre:!0,attrs:{class:"language-shell"}},[n("code",[t._v("zx https://your-remote-server.com/example-script.mjs\n")])])]),n("h3",{attrs:{id:"部分资料参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#部分资料参考"}},[t._v("#")]),t._v(" 部分资料参考")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.sitepoint.com/google-zx-write-node-shell-scripts/",target:"_blank",rel:"noopener noreferrer"}},[t._v("How to Write Shell Scripts in Node with Google’s zx Library"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://juejin.cn/post/6987307041321091079",target:"_blank",rel:"noopener noreferrer"}},[t._v("shelljs前端自动化"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://juejin.cn/post/6992743763844005902",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用javascript写shell脚本"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://juejin.cn/post/6979989936137043999",target:"_blank",rel:"noopener noreferrer"}},[t._v("nodejs写bash脚本终极方案！"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://juejin.cn/post/7048286354861457416",target:"_blank",rel:"noopener noreferrer"}},[t._v("ZX 用JavaScript写bash脚本"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://juejin.cn/post/6979989936137043999#heading-4",target:"_blank",rel:"noopener noreferrer"}},[t._v("nodejs写bash脚本终极方案！"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://juejin.cn/post/7011464539141046279",target:"_blank",rel:"noopener noreferrer"}},[t._v("zx, 如何用Javascript优雅的书写脚本命令"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://juejin.cn/post/7002536429314277384",target:"_blank",rel:"noopener noreferrer"}},[t._v("Google zx 源码浅析"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://atomcloud.cn/google-script-tool-zx/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Google 脚本工具 zx 使用教程"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://www.sitepoint.com/google-zx-write-node-shell-scripts/",target:"_blank",rel:"noopener noreferrer"}},[t._v("How to Write Shell Scripts in Node with Google’s zx Library"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://www.infoq.com/news/2021/05/zx-javascript-cli-scripts/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Zx - a Tool for Writing Better Scripts"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://blog.tericcabrel.com/write-a-better-bash-script-with-zx/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Write better bash scripts with Zx"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://blog.mastykarz.nl/create-scripts-javascript-zx/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Create scripts in JavaScript with zx"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://www.mo4tech.com/google-zx-source-code-analysis.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Google ZX source code analysis"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);